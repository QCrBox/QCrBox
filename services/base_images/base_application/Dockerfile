ARG QCRBOX_DOCKER_TAG
FROM qcrbox/base-ancestor:${QCRBOX_DOCKER_TAG}
SHELL ["/bin/bash", "-c"]

HEALTHCHECK \
    --interval=5s \
    CMD test -f /tmp/SENTINEL_QCRBOX_CLIENT_STARTUP_SUCCESSFUL.txt || exit 1

ARG QCRBOX_SUPERVISORD_CONF_DIR=${QCRBOX_SUPERVISORD_CONF_DIR}
COPY --chown=${QCRBOX_USER}:${QCRBOX_GROUP} supervisord.base_application.conf ${QCRBOX_SUPERVISORD_CONF_DIR}/

ARG QCRBOX_REGISTRY_HOST=${QCRBOX_REGISTRY_HOST}
ENV QCRBOX_REGISTRY_HOST=${QCRBOX_REGISTRY_HOST}
ARG QCRBOX_REGISTRY_PORT=${QCRBOX_REGISTRY_PORT}
ENV QCRBOX_REGISTRY_PORT=${QCRBOX_REGISTRY_PORT}

ARG QCRBOX_APPLICATION_NAME
ARG QCRBOX_APPLICATION_DIR=${QCRBOX_HOME}/${QCRBOX_APPLICATION_NAME}
